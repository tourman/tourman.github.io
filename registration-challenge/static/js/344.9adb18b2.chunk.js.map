{"version":3,"file":"static/js/344.9adb18b2.chunk.js","mappings":"qLAYA,MAAMA,EAAyCC,IAC7C,MAAMC,EAAO,IAAIC,QAIjB,OAHKD,EAAKE,IAAIH,IACZC,EAAKG,IAAIJ,EAAgBA,EATfK,QACV,CAACC,EAAGC,EAAUC,KAAK,IAAb,GAAEC,GAAIF,EAAA,OAAYD,EAAIF,IAAIK,EAAID,EAAM,GAC1C,IAAIE,MASED,IAA+B,IAADE,EACpC,OAAoB,QAApBA,EAAOV,EAAKW,IAAIZ,UAAI,IAAAW,OAAA,EAAbA,EAAeC,IAAIH,EAAG,CAC9B,EAGH,SAASI,EAAcC,GACrB,OAAOA,EAAKC,KAAKC,IAAI,IAAWA,EAAMC,SAAS,KACjD,CAEA,MAsCA,EAtCoC,SAAkBC,GAGlD,IAFFC,OAAQC,EACRN,KAAMO,GACPH,EACC,MAAOJ,EAAMQ,IAAWC,EAAAA,EAAAA,WAAyB,IAC/CV,EAAcQ,MAEhBG,EAAAA,EAAAA,kBAAgB,KACdF,EAAQT,EAAcQ,GAAW,GAChC,CAACA,IACJ,MAAMI,GAAqDC,EAAAA,EAAAA,cACxDjB,IACCa,GACEK,EAAAA,EAAAA,IAAQb,GAAOc,IAAW,IAADC,EACvB,MAAMrB,EAAQT,EAAce,EAAdf,CAAoBU,IACf,QAAnBoB,EAACD,EAAW,OAALpB,QAAK,IAALA,EAAAA,GAAU,UAAE,IAAAqB,EAAAA,EAAI,CAAC,GAAGZ,SAAU,CAAI,KAG7CG,EAAOX,GACJqB,KAAKjB,GACLiB,KAAKR,GACLS,OAAOC,GACNV,GACEK,EAAAA,EAAAA,KAASC,IAAW,IAADK,EACjB,MAAMzB,EAAQT,EAAce,EAAdf,CAAoBU,GAClCyB,OAAOC,OAAyB,QAAnBF,EAACL,EAAW,OAALpB,QAAK,IAALA,EAAAA,GAAU,UAAE,IAAAyB,EAAAA,EAAI,CAAC,EAAG,CACtCD,QACAf,SAAS,GACT,MAGP,GAEL,CAACH,EAAMM,IAET,MAAO,CAAEN,OAAMW,WACjB,C","sources":["feature/delete/useDelete.ts"],"sourcesContent":["import type * as List from 'feature/list';\nimport type * as Delete from 'feature/delete';\nimport { produce } from 'immer';\nimport { useCallback, useLayoutEffect, useState } from 'react';\n\nfunction toIndexMap<I, L extends { id: I }[]>(list: L): Map<I, number> {\n  return list.reduce(\n    (acc, { id }, index) => acc.set(id, index),\n    new Map<I, number>(),\n  );\n}\n\nconst findIndexById = <I, A extends { id: I }>(arr: A[]) => {\n  const maps = new WeakMap<A[], Map<I, number>>();\n  if (!maps.has(arr)) {\n    maps.set(arr, toIndexMap(arr));\n  }\n  return (id: I): number | undefined => {\n    return maps.get(arr)?.get(id);\n  };\n};\n\nfunction toDeleteEntry(list: List.Entry[]): Delete.Entry[] {\n  return list.map((item) => ({ ...item, loading: false }));\n}\n\nconst useDelete: Delete.UseDelete = function useDelete({\n  delete: remove,\n  list: outerList,\n}) {\n  const [list, setList] = useState<Delete.Entry[]>(() =>\n    toDeleteEntry(outerList),\n  );\n  useLayoutEffect(() => {\n    setList(toDeleteEntry(outerList));\n  }, [outerList]);\n  const onDelete: ReturnType<Delete.UseDelete>['onDelete'] = useCallback(\n    (id) => {\n      setList(\n        produce(list, (draft) => {\n          const index = findIndexById(list)(id);\n          (draft[index ?? -1] ?? {}).loading = true;\n        }),\n      );\n      remove(id)\n        .then(toDeleteEntry)\n        .then(setList)\n        .catch((error) =>\n          setList(\n            produce((draft) => {\n              const index = findIndexById(list)(id);\n              Object.assign(draft[index ?? -1] ?? {}, {\n                error,\n                loading: false,\n              });\n            }),\n          ),\n        );\n    },\n    [list, remove],\n  );\n  return { list, onDelete };\n};\n\nexport default useDelete;\n"],"names":["findIndexById","arr","maps","WeakMap","has","set","reduce","acc","_ref","index","id","Map","_maps$get","get","toDeleteEntry","list","map","item","loading","_ref2","delete","remove","outerList","setList","useState","useLayoutEffect","onDelete","useCallback","produce","draft","_draft","then","catch","error","_draft2","Object","assign"],"sourceRoot":""}